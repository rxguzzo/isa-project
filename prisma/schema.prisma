// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id        String    @id @default(uuid())
  nome      String
  email     String    @unique
  senha     String
  role      String    @default("USER")
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  // Relação: Um usuário pode possuir VÁRIAS empresas
  empresas  Empresa[]
}

model Empresa {
  id           String    @id @default(uuid())
  razaoSocial  String
  nomeFantasia String?
  cnpj         String    @unique
  endereco     String?
  telefone     String?
  emailContato String?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  problemas    Problema[]

  // Relação: Cada empresa pertence a UM e somente UM usuário
  usuarioId    String
  usuario      Usuario   @relation(fields: [usuarioId], references: [id])
}

model Problema {
  id                      String    @id @default(uuid())
  areaDemanda             String[]
  assunto                 String
  descricao               String
  objetivos               String?
  nivelUrgencia           String
  orcamento               String?
  comoConheceu            String?
  consentimentoLGPD       Boolean   @default(false)
  disponibilidadeVisita   Boolean   @default(false)
  status                  String    @default("aberto")
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt

  empresaId               String
  empresa                 Empresa   @relation(fields: [empresaId], references: [id])
}

model ConfiguracaoGlobal {
  id                     String    @id @default(uuid())
  notificacoesAtivas     Boolean   @default(true)
  modoManutencao         Boolean   @default(false)
  mensagemBoasVindas     String?
  minVersaoAppRequerida  String?
  createdAt              DateTime  @default(now())
  updatedAt              DateTime  @updatedAt
}